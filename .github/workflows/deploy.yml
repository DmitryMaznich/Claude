name: Deploy to cPanel

on:
  push:
    branches:
      - main

jobs:
  deploy:
    name: Deploy via cPanel API
    runs-on: ubuntu-latest

    steps:
      - name: Trigger cPanel Git Deployment
        run: |
          # Pull latest changes from GitHub
          curl -k -X POST "https://${{ secrets.FTP_SERVER }}:2083/execute/VersionControl/update" \
            -u "${{ secrets.FTP_USERNAME }}:${{ secrets.FTP_PASSWORD }}" \
            -d "repository_root=/home/smartw01/repositories/Claude"

          # Deploy to public_html
          curl -k -X POST "https://${{ secrets.FTP_SERVER }}:2083/execute/VersionControlDeployment/create" \
            -u "${{ secrets.FTP_USERNAME }}:${{ secrets.FTP_PASSWORD }}" \
            -d "repository_root=/home/smartw01/repositories/Claude" \
            -d "deployment_root=/home/smartw01/public_html"
